<!doctype html>
<html lang="ja">
  <head>
    <style>html{visibility:hidden}</style>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />

    <!-- MD5ライブラリ -->
    <script src="https://unpkg.com/js-md5@0.8.3/src/md5.min.js"></script>

    <!-- 簡易パスワードゲート（テスト用途） -->
<script>
  (function () {
    // 平文とMD5（どちらでも正解にする）
    const PASS_PLAIN = "summermer_daifugo";
    const PASS_HASH = "8dd2adebc69103b5614d02ee2909afb5";

    const KEY = "gate_ok_" + PASS_HASH.slice(0, 6);
    const MSG = "Password?";

    function allow() {
      sessionStorage.setItem(KEY, "1");
      document.documentElement.style.visibility = "visible";
    }
    function deny() {
      document.open();
      document.write(`<!doctype html><html lang="ja"><head>
        <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
        <title>401 Unauthorized</title>
        <style>
          html,body{height:100%}body{margin:0;display:flex;align-items:center;justify-content:center;
          font-family:system-ui,-apple-system,Segoe UI,Roboto,Meiryo,"Noto Sans JP",sans-serif;
          background:#0f172a;color:#e2e8f0}
          .card{background:#111827;border:1px solid #334155;padding:24px 28px;border-radius:12px;
          box-shadow:0 10px 30px rgba(0,0,0,.3);text-align:center}
          button{margin-top:16px;padding:10px 16px;border-radius:8px;border:1px solid #475569;
          background:#1f2937;color:#e5e7eb;cursor:pointer}
          button:hover{background:#334155}
        </style></head><body>
        <div class="card">
          <div>パスワードが違います。</div>
          <button onclick="sessionStorage.removeItem('${KEY}'); location.reload()">もう一度入力する</button>
        </div>
      </body></html>`);
      document.close();
    }

    try {
      if (sessionStorage.getItem(KEY) === "1") {
        document.documentElement.style.visibility = "visible";
        return;
      }
      const inputRaw = prompt(MSG);
      if (inputRaw == null) return deny();       // CancelもNG扱い
      const input = String(inputRaw).trim();     // 前後空白カット

      // md5があればMD5で判定／無ければ平文で判定（どちらかが一致したら通す）
      const okByHash = (typeof window.md5 === "function") && window.md5(input) === PASS_HASH;
      const okByPlain = input === PASS_PLAIN;

      if (okByHash || okByPlain) {
        allow();
      } else {
        deny();
      }
    } catch (e) {
      deny();
    }
  })();
</script>


  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="./main.tsx"></script>
  </body>
</html>
